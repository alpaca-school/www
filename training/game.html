<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¨ãƒŸã‚¿ãƒ³è·äººç´€è¡Œ</title>
    <style>
        body { font-family: sans-serif; text-align: center; background-color: #f0f8ff; padding: 20px; }
        .game-container { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); max-width: 400px; margin: auto; }
        button { font-size: 18px; margin: 10px; padding: 10px 20px; cursor: pointer; border-radius: 10px; border: 1px solid #ccc; background: #e1e1e1; }
        .money { color: #d9534f; font-weight: bold; }
        .log { text-align: left; font-size: 14px; background: #eee; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>

<div class="game-container" id="game-screen">
    <h1 id="game-title">ğŸ”¨ ãƒ¨ãƒŸã‚¿ãƒ³è·äººç´€è¡Œ</h1>
    <div id="content">
        <p>ãƒãƒ¼ãƒ åã‚’å…¥åŠ›ã—ã¦ã­ï¼</p>
        <input type="text" id="team-name" placeholder="ãƒãƒ¼ãƒ å" style="font-size: 18px; padding: 5px;"><br>
        <button onclick="startGame()">ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>
    </div>
</div>

<script>
    let teamName = "";
    let turn = 1;
    let totalProfit = 0;
    const stages = [
        { name: "å°ã•ãªå°å±‹ ğŸ ", basePrice: 50000 },
        { name: "æ™®é€šã®ãŠå®¶ ğŸ¡", basePrice: 200000 },
        { name: "è±ªè¯ãªãŠå®¶ ğŸ°", basePrice: 500000 }
    ];

    // éŸ³ã‚’é³´ã‚‰ã™ï¼ˆç°¡æ˜“ç‰ˆï¼‰
    function playSound() {
        const context = new AudioContext();
        const osc = context.createOscillator();
        const gain = context.createGain();
        osc.connect(gain);
        gain.connect(context.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(880, context.currentTime);
        gain.gain.setValueAtTime(0.1, context.currentTime);
        osc.start();
        osc.stop(context.currentTime + 0.1);
    }

    function startGame() {
        teamName = document.getElementById('team-name').value || "è¦‹ç¿’ã„";
        document.getElementById('game-title').innerText = "ğŸ”¨ " + teamName + "ã®è·äººç´€è¡Œ";
        playSound();
        showSelection();
    }

    function showSelection() {
        if (turn > 3) {
            finishGame();
            return;
        }
        let stage = stages[turn-1];
        let html = `<h3>ç¬¬ ${turn} æœŸï¼š${stage.name}</h3>`;
        html += `<p>ãƒªãƒ•ã‚©ãƒ¼ãƒ ã®è¨ˆç”»ã‚’ç«‹ã¦ã‚ˆã†ï¼</p>`;
        html += `<p>1. é›‡ã†äººæ•°ï¼š<select id="workers"><option value="1">1äºº</option><option value="3">3äºº</option></select></p>`;
        html += `<p>2. ææ–™ï¼š<select id="material"><option value="1">ãµã¤ã†</option><option value="2">é«˜ç´šâœ¨</option></select></p>`;
        html += `<button onclick="calculateTurn()">ã“ã‚Œã§æ±ºå®šï¼</button>`;
        document.getElementById('content').innerHTML = html;
    }

    function calculateTurn() {
        playSound();
        let stage = stages[turn-1];
        let workers = parseInt(document.getElementById('workers').value);
        let matLevel = parseInt(document.getElementById('material').value);

        let sales = stage.basePrice * matLevel; // é«˜ç´šãªã‚‰å£²ä¸Šã‚¢ãƒƒãƒ—
        let costs = (workers * 10000) + (stage.basePrice * 0.3 * matLevel); // äººä»¶è²»ï¼‹ææ–™è²»
        let profit = sales - costs;

        totalProfit += profit;

        let html = `<h3>çµæœå ±å‘Šæ›¸</h3>`;
        html += `<p>ğŸ’°å£²ä¸Š: ${sales.toLocaleString()}å††</p>`;
        html += `<p>ğŸ“‰çµŒè²»: ${costs.toLocaleString()}å††</p>`;
        html += `<p class="money">âœ…åˆ©ç›Š: ${profit.toLocaleString()}å††</p>`;
        html += `<button onclick="nextTurn()">æ¬¡ã®æœŸã¸</button>`;
        document.getElementById('content').innerHTML = html;
    }

    function nextTurn() {
        turn++;
        showSelection();
    }

    function finishGame() {
        let message = totalProfit > 500000 ? "ç«‹æ´¾ãªç¤¾é•·ã ã­ï¼æ©è¿”ã—å¤§æˆåŠŸï¼" : "ã¾ã ã¾ã ä¿®è¡ŒãŒå¿…è¦ã ï¼";
        let html = `<h2>æœ€çµ‚çµæœ</h2>`;
        html += `<p>åˆè¨ˆåˆ©ç›Š: <span class="money">${totalProfit.toLocaleString()}å††</span></p>`;
        html += `<p>${message} ğŸ</p>`;
        html += `<p>çµæœã‚’å ±å‘Šã™ã‚‹ï¼š<br><a href="mailto:SAD22@gmail.com?subject=ã‚²ãƒ¼ãƒ çµæœ&body=${teamName}ã®åˆ©ç›Šã¯${totalProfit}å††ã§ã—ãŸï¼">ğŸ“§ ãƒ¡ãƒ¼ãƒ«ã‚’é€ã‚‹</a></p>`;
        html += `<button onclick="location.reload()">ã‚‚ã†ä¸€åº¦ã‚ãã¶</button>`;
        document.getElementById('content').innerHTML = html;
    }
</script>

</body>
</html>
